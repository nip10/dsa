use recursion for space constrains
eg process batches of numbers from indexOf(1) to nextIndexOf(1)
